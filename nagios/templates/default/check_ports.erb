#!/bin/bash

# Split ports by comma
ports="${1//,/ }"

for port in $ports
do
    netstat -ntl | awk '{print $4}' | cut -d: -f2 | grep -xq "$port"
    status="$?"
    if [[ "$status" -ne 0 ]]
    then
        # First warning is the final result
        echo "Nothing is listening on port $port."
        exit "$status"
    fi
done

echo "All ports are OK: $ports."
